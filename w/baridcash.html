<!DOCTYPE html> 
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>BARID CASH - SPARIBET</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet" />
  <style>
    :root { --primary: #005a9c; --accent: #ffcc00; --bg: #f4f7f9; } /* ألوان بريد كاش */
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
    body { background: var(--bg); display: flex; flex-direction: column; align-items: center; min-height: 100vh; }

    /* تنبيه iOS Style */
    #customAlert {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.4); z-index: 9999; justify-content: center; align-items: center; backdrop-filter: blur(8px);
    }
    .alert-box {
      background: #fff; width: 85%; max-width: 320px; padding: 30px 20px; border-radius: 24px;
      text-align: center; box-shadow: 0 15px 50px rgba(0,0,0,0.15); transform: scale(0.8); opacity: 0;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .alert-box.show { transform: scale(1); opacity: 1; }
    .icon-wrapper { width: 70px; height: 70px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; }
    .icon-svg { width: 100%; height: 100%; }
    .alert-msg { font-size: 16px; font-weight: 700; color: #1e293b; margin-bottom: 25px; line-height: 1.6; }
    .alert-btn { background: var(--primary); color: #fff; border: none; padding: 14px; border-radius: 16px; font-weight: 800; font-size: 16px; cursor: pointer; width: 100%; }

    /* الهيدر: النص يميناً والشعار يساراً */
    header { 
      width: 100%; background: #fff; padding: 15px 25px; display: flex; 
      flex-direction: row-reverse; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
    }
    .logo-brand { font-weight: 900; font-size: 1.4rem; color: var(--primary); }
    .logo-brand span { color: var(--accent); }
    .header-logo-bank { height: 35px; object-fit: contain; }

    .container { width: 100%; max-width: 440px; padding: 20px; }
    .card { background: #fff; border-radius: 30px; padding: 25px; box-shadow: 0 15px 35px rgba(0,0,0,0.05); border: 1px solid #eef2f6; position: relative; }
    .card-line { position: absolute; top: 0; left: 0; width: 100%; height: 6px; background: linear-gradient(90deg, var(--primary), var(--accent)); border-radius: 30px 30px 0 0; }
    .bank-brand-main { text-align: center; margin-bottom: 20px; padding-top: 10px; }
    .bank-brand-main img { height: 50px; object-fit: contain; }
    
    .notice { background: #f0f7ff; border-right: 4px solid var(--primary); color: #004070; padding: 12px; border-radius: 12px; font-size: 13px; font-weight: 700; margin-bottom: 20px; line-height: 1.5; }
    .info-box { background: #fafafa; padding: 12px 15px; border-radius: 15px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border: 1px solid #eee; }
    .info-box span { font-weight: 800; color: var(--primary); font-size: 14px; }
    .btn-copy { background: #fff; border: 1.5px solid var(--primary); padding: 5px 12px; border-radius: 10px; cursor: pointer; font-size: 11px; font-weight: 800; color: var(--primary); }
    
    .field { margin-bottom: 20px; }
    .field label { display: block; font-size: 13px; font-weight: 800; margin-bottom: 8px; color: #475569; }
    .input-box { width: 100%; height: 55px; border: 2px solid #e2e8f0; border-radius: 16px; padding: 0 15px; font-size: 16px; font-weight: 700; outline: none; text-align: right; }
    
    .reçu-zone { width: 100%; border: 2px dashed #cbd5e1; border-radius: 20px; background: #fafafa; padding: 15px; display: flex; align-items: center; gap: 15px; position: relative; cursor: pointer; min-height: 90px; }
    .reçu-zone input { position: absolute; width: 100%; height: 100%; opacity: 0; cursor: pointer; z-index: 10; }
    .plus-square { width: 55px; height: 55px; background: #e2e8f0; border: 2px solid #fff; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 28px; color: #94a3b8; font-weight: 300; flex-shrink: 0; }
    #reçuPreview { height: 65px; width: 65px; object-fit: cover; border-radius: 10px; display: none; border: 2px solid #fff; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    
    .submit-btn { width: 100%; height: 60px; background: var(--primary); color: #fff; border: none; border-radius: 18px; font-size: 18px; font-weight: 900; cursor: pointer; box-shadow: 0 8px 20px rgba(0, 90, 156, 0.2); margin-top: 10px; }
  </style>
</head>
<body>

  <div id="customAlert">
    <div class="alert-box" id="alertBox">
      <div class="icon-wrapper" id="alertIconBox"></div>
      <div class="alert-msg" id="alertText"></div>
      <button class="alert-btn" onclick="closeAlert()">حسناً</button>
    </div>
  </div>

  <header>
    <div class="logo-brand">SPARI<span>BET</span></div>
    <img src="https://i.ibb.co/LzbjcNJQ/baridcash.png" alt="Barid Cash Logo" class="header-logo-bank">
  </header>

  <div class="container">
    <div class="card">
      <div class="card-line"></div>
      <div class="bank-brand-main"><img src="https://i.ibb.co/LzbjcNJQ/baridcash.png" alt="Barid Cash Logo"></div>
      <div class="notice">المرجو إرسال المبلغ عبر Barid Cash للمستلم أسفله، ثم ارفع صورة التوصيل.</div>
      <div class="info-box"><span>OTHMAN HABT</span><button class="btn-copy" onclick="copy('OTHMAN HABT')">نسخ الاسم</button></div>
      <div class="info-box"><span>0603230990</span><button class="btn-copy" onclick="copy('0603230990')">نسخ CIN</button></div>
      
      <div class="field">
        <label>المبلغ المراد شحنه (MAD):</label>
        <input type="number" class="input-box" id="amount" placeholder="200">
      </div>
      
      <div class="field">
        <label>صورة التوصيل (Capture):</label>
        <div class="reçu-zone">
          <div class="plus-square" id="plusBtn">+</div>
          <img id="reçuPreview" alt="Thumbnail">
          <input type="file" id="fileInput" accept="image/*" onchange="showImage()">
        </div>
      </div>
      
      <div class="field">
        <label>الإسم الكامل :</label>
        <input type="text" class="input-box" id="fullname" placeholder="الاسم الكامل">
      </div>
      
      <button class="submit-btn" id="submitBtn" onclick="sendOrder()">تأكيد عملية الشحن</button>
    </div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyBNG4GFGdi9_aE89qa3eXRksG8_B3-cBuvYolo3F6Fq6eAvqN8XJFIamURlIWMxFZf/exec";
    const IMGBB_KEY = "6d2f8ab6047b7c098bb9a2383f8aed39";

    const icons = {
      warn: `<svg class="icon-svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="#FFCC00"/><path d="M50 25v30M50 65v5" stroke="#fff" stroke-width="8" stroke-linecap="round"/></svg>`,
      success: `<svg class="icon-svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="#28CD41"/><path d="M30 50l15 15 25-30" fill="none" stroke="#fff" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/></svg>`,
      error: `<svg class="icon-svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="45" fill="#FF3B30"/><path d="M35 35l30 30M65 35l-30 30" stroke="#fff" stroke-width="8" stroke-linecap="round"/></svg>`
    };

    function showAlert(msg, type = 'warn') {
      document.getElementById('alertText').innerText = msg;
      document.getElementById('alertIconBox').innerHTML = icons[type];
      const modal = document.getElementById('customAlert');
      const box = document.getElementById('alertBox');
      modal.style.display = 'flex';
      setTimeout(() => box.classList.add('show'), 10);
    }

    function closeAlert() {
      const box = document.getElementById('alertBox');
      box.classList.remove('show');
      setTimeout(() => { document.getElementById('customAlert').style.display = 'none'; }, 200);
    }

    function copy(txt) {
      navigator.clipboard.writeText(txt);
      showAlert("تم نسخ المعلومات بنجاح!", "success");
    }

    function showImage() {
      const file = document.getElementById('fileInput').files[0];
      const preview = document.getElementById('reçuPreview');
      const plus = document.getElementById('plusBtn');
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => { 
          preview.src = e.target.result; 
          preview.style.display = 'block'; 
          plus.style.display = 'none';
        }
        reader.readAsDataURL(file);
      }
    }

    async function sendOrder() {
      const amount = document.getElementById('amount').value;
      const name = document.getElementById('fullname').value;
      const file = document.getElementById('fileInput').files[0];
      const btn = document.getElementById('submitBtn');

      if (!amount || !name || !file) {
        showAlert("المرجو ملء جميع المعلومات.", "warn");
        return;
      }

      btn.disabled = true;
      btn.innerText = "⏳ جاري الإرسال...";

      try {
        const formData = new FormData();
        formData.append("image", file);
        const imgRes = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`, { method: "POST", body: formData });
        const imgJson = await imgRes.json();

        await fetch(SCRIPT_URL, {
          method: 'POST',
          mode: 'no-cors',
          body: JSON.stringify({ 
            amount: amount, 
            fullname: name, 
            receiptUrl: imgJson.data.url,
            bank: "BARID CASH"
          })
        });

        showAlert("تم إرسال طلب الشحن بنجاح (Barid Cash).", "success");
        btn.innerText = "إرسال طلب آخر";
        btn.disabled = false;
        
        document.getElementById('amount').value = '';
        document.getElementById('fullname').value = '';
        document.getElementById('reçuPreview').style.display = 'none';
        document.getElementById('plusBtn').style.display = 'flex';
      } catch (err) {
        showAlert("عذراً، حدث خطأ ما.", "error");
        btn.disabled = false;
        btn.innerText = "تأكيد عملية الشحن";
      }
    }
  </script>
</body>
</html>
